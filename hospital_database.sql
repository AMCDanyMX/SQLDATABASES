CREATE TABLE PACIENTE(
ID_PACIENTE CHAR(5) CONSTRAINT PACIENTE_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT PA_NOM_NN NOT NULL,
APATERNO VARCHAR2(50) CONSTRAINT PA_AP_NN NOT NULL,
AMATERNO VARCHAR2(50) DEFAULT '**********',
EDAD NUMBER(3,0),
PESO NUMBER(3,2),
ESTATURA NUMBER(2,2),
TIPO_SANGRE VARCHAR2(10),
TELEFONO VARCHAR2(10) DEFAULT '**********'
);
ALTER TABLE PACIENTE MODIFY PESO NUMBER(4,1);
ALTER TABLE PACIENTE MODIFY ESTATURA NUMBER(2,1);
INSERT INTO PACIENTE VALUES('PA001','MANUEL','DURAN','CUEVAS',23,80,1.7,'a+','4921234567');
INSERT INTO PACIENTE VALUES('PA002','ALEJANDO','DURAN','CUEVAS',33,70,1.7,'b+','4921234562');
INSERT INTO PACIENTE VALUES('PA003','CHUMEL','DURAN','CUEVAS',43,60,1.7,'ab+','4921234563');
INSERT INTO PACIENTE VALUES('PA004','JORGEL','DURAN','CUEVAS',53,50,1.7,'a+','4921234564');
INSERT INTO PACIENTE VALUES('PA005','JUAN','DURAN','CUEVAS',63,40,1.7,'b+','4921234565');
INSERT INTO PACIENTE VALUES('PA006','TAYLUSS','APA','APA',73,40,1.7,'b+','4921234565');
INSERT INTO PACIENTE VALUES('PA007','SUSHI','PEREZ','LOPEZ',73,40,1.7,'b+','4921234565');
SELECT * FROM PACIENTE;

CREATE TABLE ASISTENTE(
ID_ASISTENTE CHAR(5) CONSTRAINT ASISTENTE_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT ASIS_NOM_NN NOT NULL,
APATERNO VARCHAR2(50) CONSTRAINT ASIS_AP_NN NOT NULL,
AMATERNO VARCHAR2(50) DEFAULT '**********',
TELEFONO VARCHAR2(10) DEFAULT '**********',
CORREO VARCHAR2(50) DEFAULT '**********',
SALARIO NUMBER(5,0) CONSTRAINT ASIS_SAL_NN NOT NULL CONSTRAINT ASIS_SAL_CK CHECK (SALARIO>=12000 AND SALARIO<=20000)
);
INSERT INTO ASISTENTE VALUES('AS001','CRISTIANO','FLORES','VAZQUEZ','5921234567','CR@GMAIL.COM',12000);
INSERT INTO ASISTENTE VALUES('AS002','RONALDO','FLORES','VAZQUEZ','5921234562','RO@GMAIL.COM',12000);
INSERT INTO ASISTENTE VALUES('AS003','MESSI','FLORES','VAZQUEZ','5921234563','ME@GMAIL.COM',12000);
INSERT INTO ASISTENTE VALUES('AS004','NEYMAR','FLORES','VAZQUEZ','5921234564','NE@GMAIL.COM',12000);
INSERT INTO ASISTENTE VALUES('AS005','PELE','FLORES','VAZQUEZ','5921234565','PE@GMAIL.COM',12000);
SELECT * FROM ASISTENTE;


CREATE TABLE MEDICO(
ID_MEDICO CHAR(5) CONSTRAINT MEDICO_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT MED_NOM_NN NOT NULL,
APATERNO VARCHAR2(50) CONSTRAINT MED_AP_NN NOT NULL,
AMATERNO VARCHAR2(50) DEFAULT '**********',
TELEFONO VARCHAR2(10) DEFAULT '**********',
CORREO VARCHAR2(50) DEFAULT '**********',
SALARIO NUMBER(5,0) CONSTRAINT MED_SAL_NN NOT NULL CONSTRAINT MED_SAL_CK CHECK (SALARIO>=12000 AND SALARIO<=20000)
);
INSERT INTO MEDICO VALUES('ME001','CAMACHO','MARQUEZ','VAZQUEZ','6921234567','CA@GMAIL.COM',12000);
INSERT INTO MEDICO VALUES('ME002','ROMEO','MARQUEZ','VAZQUEZ','6921234562','ROM@GMAIL.COM',12000);
INSERT INTO MEDICO VALUES('ME003','THIAGO','MARQUEZ','VAZQUEZ','6921234563','TH@GMAIL.COM',12000);
INSERT INTO MEDICO VALUES('ME004','LEO','MARQUEZ','VAZQUEZ','6921234564','LEO@GMAIL.COM',12000);
INSERT INTO MEDICO VALUES('ME005','HULK','MARQUEZ','VAZQUEZ','6921234565','HU@GMAIL.COM',12000);
INSERT INTO MEDICO VALUES('ME006','JAIMITO','EL','CARTERO','6921234565','HU@GMAIL.COM',12000);
SELECT * FROM MEDICO;

CREATE TABLE CONSULTORIO(
ID_CONSULTORIO CHAR(5) CONSTRAINT CONSULTORIO_PK PRIMARY KEY,
NUM_CAMILLAS VARCHAR2(50) CONSTRAINT CONS_CAM_NN NOT NULL,
NUM_PESAS VARCHAR2(50) CONSTRAINT CONS_PES_NN NOT NULL,
NUM_BASCULAS VARCHAR2(50) CONSTRAINT CONS_BAS_NN NOT NULL
);
INSERT INTO CONSULTORIO VALUES('CO001','1','1','1');
INSERT INTO CONSULTORIO VALUES('CO002','1','1','1');
INSERT INTO CONSULTORIO VALUES('CO003','1','1','1');
INSERT INTO CONSULTORIO VALUES('CO004','1','1','1');
INSERT INTO CONSULTORIO VALUES('CO005','1','1','1');
SELECT * FROM CONSULTORIO;

CREATE TABLE TIPO_ANALISIS(
ID_TIPO_ANALISIS CHAR(5) CONSTRAINT TIPO_ANALISIS_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT TA_NOM_NN NOT NULL
);
INSERT INTO TIPO_ANALISIS VALUES ('TA001','LEVE');
INSERT INTO TIPO_ANALISIS VALUES ('TA002','COMUN');
INSERT INTO TIPO_ANALISIS VALUES ('TA003','INTERMEDIO');
INSERT INTO TIPO_ANALISIS VALUES ('TA004','SEVERO');
INSERT INTO TIPO_ANALISIS VALUES ('TA005','MOERTAL');
SELECT * FROM TIPO_ANALISIS;

CREATE TABLE MEDICAMENTO(
ID_MEDICAMENTO CHAR(5) CONSTRAINT MEDICAMENTO_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT MEDICA_NOM_NN NOT NULL,
CADUCIDAD DATE CONSTRAINT MEDICA_CAD_NN NOT NULL
);
INSERT INTO MEDICAMENTO VALUES ('ME001','PARACETAMOL','29-10-2080');
INSERT INTO MEDICAMENTO VALUES ('ME002','AMBROXOL','29-10-2080');
INSERT INTO MEDICAMENTO VALUES ('ME003','ASPIRINA','29-10-2080');
INSERT INTO MEDICAMENTO VALUES ('ME004','MEJORALITO','29-10-2080');
INSERT INTO MEDICAMENTO VALUES ('ME005','AMPOLLETA','29-10-2080');
INSERT INTO MEDICAMENTO VALUES ('ME006','PASTILLITAS','29-10-2080');
SELECT * FROM MEDICAMENTO;

CREATE TABLE CUARTO(
NUM_CUARTO CHAR(5) CONSTRAINT CUARTO_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT CU_NOM_NN NOT NULL
);
INSERT INTO CUARTO VALUES ('CU001','CUARTO 1');
INSERT INTO CUARTO VALUES ('CU002','CUARTO 2');
INSERT INTO CUARTO VALUES ('CU003','CUARTO 3');
INSERT INTO CUARTO VALUES ('CU004','CUARTO 4');
INSERT INTO CUARTO VALUES ('CU005','CUARTO 5');
SELECT * FROM CUARTO;

CREATE TABLE ENFERMERA(
ID_ENFERMERA CHAR(5) CONSTRAINT ENFERMERA_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT ENF_NOM_NN NOT NULL,
APATERNO VARCHAR2(50) CONSTRAINT ENF_AP_NN NOT NULL,
AMATERNO VARCHAR2(50) DEFAULT '**********',
TELEFONO VARCHAR2(10) DEFAULT '**********',
CORREO VARCHAR2(50) DEFAULT '**********',
SALARIO NUMBER(5,0) CONSTRAINT ENF_SAL_NN NOT NULL CONSTRAINT ENF_SAL_CK CHECK (SALARIO>=12000 AND SALARIO<=20000)
);
INSERT INTO ENFERMERA VALUES('EN001','LUCERO','FLORES','CORTES','5921234567','LU@GMAIL.COM',12000);
INSERT INTO ENFERMERA VALUES('EN002','IVANNA','FLORES','OCHOA','5921234562','IV@GMAIL.COM',12000);
INSERT INTO ENFERMERA VALUES('EN003','ALONDRA','FLORES','RAMOS','5921234563','AL@GMAIL.COM',12000);
INSERT INTO ENFERMERA VALUES('EN004','VALERIA','FLORES','SALINAS','5921234564','VA@GMAIL.COM',12000);
INSERT INTO ENFERMERA VALUES('EN005','TANIA','FLORES','VALLES','5921234565','TA@GMAIL.COM',12000);
SELECT * FROM ENFERMERA;

CREATE TABLE EXPEDIENTE(
FOLIO_CONSULTA CHAR(5),
NUM_CITA CHAR(5),
ID_PACIENTE CHAR(5),
ID_ASISTENTE CHAR(5),
ID_MEDICO CHAR(5),
ID_CONSULTORIO CHAR(5),
ANTESEDENTES VARCHAR2(100) CONSTRAINT EXP_ANT_NN NOT NULL,
CONSTRAINT CONS_EXP_FK  FOREIGN KEY (FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO) REFERENCES CONSULTA(FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO)
);
INSERT INTO EXPEDIENTE VALUES('FC001','CI001','PA001','AS001','ME001','CO001','TIENE DIABETES');
INSERT INTO EXPEDIENTE VALUES('FC001','CI001','PA001','AS001','ME001','CO001','TIENE ASMA');
INSERT INTO EXPEDIENTE VALUES('FC001','CI001','PA001','AS001','ME001','CO001','TIENE TEMPERATURA');
INSERT INTO EXPEDIENTE VALUES('FC001','CI001','PA001','AS001','ME001','CO001','TIENE CANCER');
INSERT INTO EXPEDIENTE VALUES('FC001','CI001','PA001','AS001','ME001','CO001','TIENE SIDA');
SELECT * FROM EXPEDIENTE;

CREATE TABLE CITA(
NUM_CITA CHAR(5) CONSTRAINT CI_NC_NN NOT NULL,
FECHA DATE CONSTRAINT CI_FE_NN NOT NULL,
ID_PACIENTE CHAR(5),
ID_ASISTENTE CHAR(5),
CONSTRAINT CITA_PK PRIMARY KEY (NUM_CITA,ID_PACIENTE,ID_ASISTENTE),
CONSTRAINT PAC_CI_FK FOREIGN KEY (ID_PACIENTE) REFERENCES PACIENTE(ID_PACIENTE),
CONSTRAINT ASIS_CI_FK FOREIGN KEY (ID_ASISTENTE) REFERENCES ASISTENTE(ID_ASISTENTE)
);
INSERT INTO CITA VALUES ('CI001','20-05-2020','PA001','AS001');
INSERT INTO CITA VALUES ('CI002','20-05-2020','PA002','AS002');
INSERT INTO CITA VALUES ('CI003','20-05-2020','PA003','AS003');
INSERT INTO CITA VALUES ('CI004','20-05-2020','PA004','AS004');
INSERT INTO CITA VALUES ('CI005','20-05-2020','PA005','AS005');
INSERT INTO CITA VALUES ('CI006','20-05-2020','PA005','AS004');
INSERT INTO CITA VALUES ('CI007','20-05-2020','PA006','AS005');
INSERT INTO CITA VALUES ('CI008','20-05-2020','PA007','AS005');
SELECT * FROM CITA;

CREATE TABLE CONSULTA(
FOLIO_CONSULTA CHAR(5) CONSTRAINT CONSUL_FC_NN NOT NULL,
FECHA DATE CONSTRAINT CONSUL_FE_NN NOT NULL,
NUM_CITA CHAR(5),
ID_PACIENTE CHAR(5),
ID_ASISTENTE CHAR(5),
ID_MEDICO CHAR(5),
ID_CONSULTORIO CHAR(5),
CONSTRAINT CONSULTA_PK PRIMARY KEY (FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO),
CONSTRAINT CITA_CONSUL_FK FOREIGN KEY (NUM_CITA,ID_PACIENTE,ID_ASISTENTE) REFERENCES CITA(NUM_CITA,ID_PACIENTE,ID_ASISTENTE),
CONSTRAINT MED_CONSUL_FK FOREIGN KEY (ID_MEDICO) REFERENCES MEDICO(ID_MEDICO),
CONSTRAINT CONS_CONSUL_FK FOREIGN KEY (ID_CONSULTORIO) REFERENCES CONSULTORIO(ID_CONSULTORIO)
);
INSERT INTO CONSULTA VALUES ('FC001','29-05-2020','CI001','PA001','AS001','ME001','CO001');
INSERT INTO CONSULTA VALUES ('FC002','29-05-2020','CI002','PA002','AS002','ME002','CO002');
INSERT INTO CONSULTA VALUES ('FC003','29-05-2020','CI003','PA003','AS003','ME003','CO003');
INSERT INTO CONSULTA VALUES ('FC004','29-05-2020','CI004','PA004','AS004','ME004','CO004');
INSERT INTO CONSULTA VALUES ('FC005','29-05-2020','CI005','PA005','AS005','ME005','CO005');
INSERT INTO CONSULTA VALUES ('FC006','29-05-2020','CI006','PA005','AS004','ME005','CO005');
INSERT INTO CONSULTA VALUES ('FC007','29-05-2020','CI008','PA007','AS005','ME005','CO005');
SELECT * FROM CONSULTA;

CREATE TABLE ANALISIS_CLINICO(
NUM_ANALISIS CHAR(5) CONSTRAINT AC_NA_NN NOT NULL,
FOLIO_CONSULTA CHAR(5),
NUM_CITA CHAR(5),
ID_PACIENTE CHAR(5),
ID_ASISTENTE CHAR(5),
ID_MEDICO CHAR(5),
ID_CONSULTORIO CHAR(5),
ID_TIPO_ANALISIS CHAR(5),
CONSTRAINT ANALISIS_CLINICO_PK PRIMARY KEY (NUM_ANALISIS,FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO,ID_TIPO_ANALISIS),
CONSTRAINT CONS_AC_FK  FOREIGN KEY (FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO) REFERENCES CONSULTA(FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO),
CONSTRAINT TA_AC_FK FOREIGN KEY (ID_TIPO_ANALISIS) REFERENCES TIPO_ANALISIS(ID_TIPO_ANALISIS)
);
INSERT INTO ANALISIS_CLINICO VALUES ('AC001','FC001','CI001','PA001','AS001','ME001','CO001','TA001');
INSERT INTO ANALISIS_CLINICO VALUES ('AC002','FC002','CI002','PA002','AS002','ME002','CO002','TA002');
INSERT INTO ANALISIS_CLINICO VALUES ('AC003','FC003','CI003','PA003','AS003','ME003','CO003','TA003');
INSERT INTO ANALISIS_CLINICO VALUES ('AC004','FC004','CI004','PA004','AS004','ME004','CO004','TA004');
INSERT INTO ANALISIS_CLINICO VALUES ('AC005','FC005','CI005','PA005','AS005','ME005','CO005','TA005');
SELECT * FROM ANALISIS_CLINICO;

CREATE TABLE RECETA(
NUM_RECETA CHAR(5) CONSTRAINT REC_NC_NN NOT NULL,
FECHA DATE,
FOLIO_CONSULTA CHAR(5),
NUM_CITA CHAR(5),
ID_PACIENTE CHAR(5),
ID_ASISTENTE CHAR(5),
ID_MEDICO CHAR(5),
ID_CONSULTORIO CHAR(5),
ID_MEDICAMENTO CHAR(5),
CONSTRAINT RECETA_PK PRIMARY KEY (NUM_RECETA,FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO,ID_MEDICAMENTO),
CONSTRAINT CONS_RE_FK  FOREIGN KEY (FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO) REFERENCES CONSULTA(FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO),
CONSTRAINT MEDICA_RE_FK FOREIGN KEY (ID_MEDICAMENTO) REFERENCES MEDICAMENTO(ID_MEDICAMENTO)
);
INSERT INTO RECETA VALUES ('RE001','29-05-2020','FC001','CI001','PA001','AS001','ME001','CO001','ME001');
INSERT INTO RECETA VALUES ('RE002','29-05-2020','FC002','CI002','PA002','AS002','ME002','CO002','ME002');
INSERT INTO RECETA VALUES ('RE003','29-05-2020','FC003','CI003','PA003','AS003','ME003','CO003','ME003');
INSERT INTO RECETA VALUES ('RE004','29-05-2020','FC004','CI004','PA004','AS004','ME004','CO004','ME004');
INSERT INTO RECETA VALUES ('RE005','29-05-2020','FC005','CI005','PA005','AS005','ME005','CO005','ME005');
SELECT * FROM RECETA;

CREATE TABLE HOSPITALIZACION(
ID_HOSPITALIZACION CHAR(5) CONSTRAINT HOS_IH_NN NOT NULL,
FOLIO_CONSULTA CHAR(5),
NUM_CITA CHAR(5),
ID_PACIENTE CHAR(5),
ID_ASISTENTE CHAR(5),
ID_MEDICO CHAR(5),
ID_CONSULTORIO CHAR(5),
NUM_CUARTO CHAR(5),
ID_ENFERMERA CHAR(5),
CONSTRAINT HOSPITALIZACION_PK PRIMARY KEY (ID_HOSPITALIZACION,FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO,NUM_CUARTO,ID_ENFERMERA),
CONSTRAINT RE_HOS_FK  FOREIGN KEY (FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO) REFERENCES CONSULTA(FOLIO_CONSULTA,NUM_CITA,ID_PACIENTE,ID_ASISTENTE,ID_MEDICO,ID_CONSULTORIO),
CONSTRAINT CUA_HOS_FK FOREIGN KEY (NUM_CUARTO) REFERENCES CUARTO(NUM_CUARTO),
CONSTRAINT ENF_HOS_FK FOREIGN KEY (ID_ENFERMERA) REFERENCES ENFERMERA(ID_ENFERMERA)
);
INSERT INTO HOSPITALIZACION VALUES ('HO001','FC001','CI001','PA001','AS001','ME001','CO001','CU001','EN001');
INSERT INTO HOSPITALIZACION VALUES ('HO002','FC002','CI002','PA002','AS002','ME002','CO002','CU002','EN002');
INSERT INTO HOSPITALIZACION VALUES ('HO003','FC003','CI003','PA003','AS003','ME003','CO003','CU003','EN003');
INSERT INTO HOSPITALIZACION VALUES ('HO004','FC004','CI004','PA004','AS004','ME004','CO004','CU004','EN004');
INSERT INTO HOSPITALIZACION VALUES ('HO005','FC005','CI005','PA005','AS005','ME005','CO005','CU005','EN005');
INSERT INTO HOSPITALIZACION VALUES ('HO006','FC006','CI006','PA005','AS004','ME005','CO005','CU005','EN005');
SELECT * FROM HOSPITALIZACION;

--1: Consultar el nombre de completo de los médicos que han realizado al menos una consulta.
SELECT * FROM MEDICO;
SELECT * FROM CONSULTA;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS TOTAL FROM MEDICO M JOIN CONSULTA C ON M.ID_MEDICO = C.ID_MEDICO
GROUP BY APATERNO, AMATERNO, NOMBRE;
--2: Consultar el nombre completo de los pacientes que han sido consultados.
SELECT * FROM PACIENTE;
SELECT * FROM CONSULTA;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE AS PACIENTES_CONSULTADOS FROM PACIENTE P JOIN CONSULTA C 
ON P.ID_PACIENTE = C.ID_PACIENTE GROUP BY APATERNO, AMATERNO, NOMBRE;
--3: Consultar el nombre completo de los pacientes que han sido consultados e incluir el nombre completo del médico.
SELECT * FROM PACIENTE;
SELECT * FROM MEDICO;
SELECT * FROM CONSULTA;
SELECT P.APATERNO || ' ' || P.AMATERNO || ' ' || P.NOMBRE AS PACIENTE_CONSULTADO,
       M.APATERNO || ' ' || M.AMATERNO || ' ' || M.NOMBRE AS MEDICO
       FROM PACIENTE P JOIN CONSULTA C ON P.ID_PACIENTE = C.ID_PACIENTE
                       JOIN MEDICO M ON M.ID_MEDICO = C.ID_MEDICO;
--4: Consultar nombre completo de los pacientes y el tipo de análisis que se le han realizado.
SELECT * FROM ANALISIS_CLINICO;
SELECT * FROM TIPO_ANALISIS;
SELECT * FROM PACIENTE;
SELECT P.APATERNO, P.AMATERNO, P.NOMBRE,
       TA.NOMBRE AS ANALISIS FROM PACIENTE P JOIN ANALISIS_CLINICO AC ON P.ID_PACIENTE = AC.ID_PACIENTE
                                 JOIN TIPO_ANALISIS TA ON TA.ID_TIPO_ANALISIS = AC.ID_TIPO_ANALISIS;
--5: Consultar el nombre completo de los pacientes que han sido hospitalizados.
SELECT * FROM HOSPITALIZACION;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE "PACIENTES HOSPITALIZADOS" FROM PACIENTE P JOIN HOSPITALIZACION H ON P.ID_PACIENTE = H.ID_PACIENTE;
--6: Consultar el nombre completo de los pacientes y el nombre de los medicamentos que le han sido recetados.
SELECT * FROM CONSULTA;
SELECT * FROM RECETA;
SELECT * FROM MEDICAMENTO;
SELECT P.APATERNO || ' ' || P.AMATERNO || ' ' || P.NOMBRE AS PACIENTE,
       M.NOMBRE AS MEDICAMENTO FROM PACIENTE P JOIN RECETA R ON P.ID_PACIENTE = R.ID_PACIENTE
                                               JOIN MEDICAMENTO M ON M.ID_MEDICAMENTO = R.ID_MEDICAMENTO;
--7: Consultar el nombre completo de los médicos y el total de consultas que han realizado.
SELECT * FROM MEDICO;
SELECT * FROM CONSULTA;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS TOTAL FROM MEDICO M JOIN CONSULTA C ON M.ID_MEDICO = C.ID_MEDICO
GROUP BY APATERNO, AMATERNO, NOMBRE;
--8: Consultar el nombre de los médicos que no han realizado consultas.
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE AS MEDICOS_SIN_CONSULTAS FROM MEDICO WHERE ID_MEDICO NOT IN(SELECT ID_MEDICO FROM CONSULTA);
--9: Consultar el nombre completo de los pacientes y el total de consultas que ha tenido cada uno.
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS TOTAL_CONSULTAS FROM PACIENTE P JOIN CONSULTA C ON P.ID_PACIENTE = C.ID_PACIENTE
GROUP BY APATERNO, AMATERNO, NOMBRE;
--10: Consultar el nombre de los medicamentos que no se han recetado.
SELECT * FROM RECETA;
SELECT * FROM MEDICAMENTO;
SELECT NOMBRE FROM MEDICAMENTO WHERE ID_MEDICAMENTO NOT IN(SELECT ID_MEDICAMENTO FROM RECETA);
-- 11: Consultar el nombre completo de los pacientes que más consultas han tenido
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS CONSULTAS FROM PACIENTE P JOIN CONSULTA C ON P.ID_PACIENTE = C.ID_PACIENTE
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) AS CONSULTAS FROM PACIENTE P JOIN CONSULTA C ON P.ID_PACIENTE = C.ID_PACIENTE GROUP BY APATERNO, AMATERNO, NOMBRE);
-- 12: Consultar el nombre completo de los médicos que más consultas han tenido.
SELECT * FROM CONSULTA;
SELECT * FROM MEDICO;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS CONSULTAS FROM MEDICO M JOIN CONSULTA C ON M.ID_MEDICO = C.ID_MEDICO
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) AS CONSULTAS FROM MEDICO M JOIN CONSULTA C ON M.ID_MEDICO = C.ID_MEDICO GROUP BY APATERNO, AMATERNO, NOMBRE);
-- 13: Consultar el nombre completo de los pacientes que más han sido hospitalizados.
SELECT * FROM HOSPITALIZACION;
SELECT * FROM PACIENTE;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS HOSPITALIZACIONES FROM PACIENTE P JOIN HOSPITALIZACION H ON P.ID_PACIENTE = H.ID_PACIENTE
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) AS HOSPITALIZACIONES FROM PACIENTE P JOIN HOSPITALIZACION H ON P.ID_PACIENTE = H.ID_PACIENTE GROUP BY APATERNO, AMATERNO, NOMBRE);
-- 14: Consultar el nombre completo de las enfermeras que más pacientes han atendido.
SELECT * FROM HOSPITALIZACION;
SELECT * FROM ENFERMERA;
SELECT E.APATERNO, E.AMATERNO, E.NOMBRE, COUNT(*) AS PACIENTES FROM ENFERMERA E JOIN HOSPITALIZACION H ON E.ID_ENFERMERA = H.ID_ENFERMERA
                                                                          JOIN PACIENTE P ON P.ID_PACIENTE = H.ID_PACIENTE
GROUP BY E.APATERNO, E.AMATERNO, E.NOMBRE
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) AS PACIENTES FROM ENFERMERA E JOIN HOSPITALIZACION H ON E.ID_ENFERMERA = H.ID_ENFERMERA
                                                  JOIN PACIENTE P ON P.ID_PACIENTE = H.ID_PACIENTE
GROUP BY E.APATERNO, E.AMATERNO, E.NOMBRE);
-- 15: Consultar al médico del año (El médico que más consultas realizó en un determinado año).
SELECT * FROM CONSULTA;
SELECT * FROM MEDICO;
SELECT ID_MEDICO FROM CONSULTA WHERE FECHA BETWEEN '01-01-20' AND '30-12-20';
SELECT M.APATERNO, M.AMATERNO, M.NOMBRE, COUNT(*) FROM MEDICO M JOIN CONSULTA C ON M.ID_MEDICO = C.ID_MEDICO
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) FROM MEDICO M JOIN CONSULTA C ON M.ID_MEDICO = C.ID_MEDICO
                                                  JOIN PACIENTE P ON P.ID_PACIENTE = C.ID_PACIENTE
                                                   WHERE FECHA BETWEEN '01-01-20' AND '30-12-20'
GROUP BY M.APATERNO, M.AMATERNO, M.NOMBRE);
-- 16: Consultar el nombre completo de los pacientes que no se han realizado análisis clínicos.
SELECT * FROM ANALISIS_CLINICO;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE "PACIENTE SIN ANALISIS CLINICO" FROM PACIENTE WHERE ID_PACIENTE NOT IN(SELECT ID_PACIENTE FROM ANALISIS_CLINICO);
-- 17: Consultar el nombre completo de los pacientes que sacaron cita pero no asistieron a la consulta.
SELECT * FROM PACIENTE;
SELECT * FROM CITA;
SELECT * FROM CONSULTA;
SELECT APATERNO, AMATERNO, NOMBRE FROM PACIENTE P JOIN CITA C ON P.ID_PACIENTE = C.ID_PACIENTE WHERE P.ID_PACIENTE NOT IN(SELECT ID_PACIENTE FROM CONSULTA);
-- 18: Consultar el nombre completo de los pacientes que fueron consultados pero que no fueron hospitalizados.
SELECT * FROM CONSULTA;
SELECT * FROM HOSPITALIZACION;
SELECT * FROM PACIENTE;
SELECT APATERNO, AMATERNO, NOMBRE FROM PACIENTE P JOIN CONSULTA C ON P.ID_PACIENTE = C.ID_PACIENTE WHERE P.ID_PACIENTE NOT IN(SELECT ID_PACIENTE FROM HOSPITALIZACION);
-- 19: Consultar el nombre completo de la asistente del mes (La asistente que más cita generó en un determinado mes).
SELECT * FROM ASISTENTE;
SELECT * FROM CITA;
SELECT A.APATERNO, A.AMATERNO, A.NOMBRE, COUNT(*) AS CITAS_EN_MAYO FROM ASISTENTE A JOIN CITA C ON A.ID_ASISTENTE = C.ID_ASISTENTE
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) FROM ASISTENTE A JOIN CITA C ON A.ID_ASISTENTE = C.ID_ASISTENTE WHERE FECHA BETWEEN '01-05-20' AND '30-05-20'
GROUP BY APATERNO , AMATERNO, NOMBRE);
-- 20: Consultar el nombre completo del médico que menos consultas ha tenido.
SELECT * FROM MEDICO;
SELECT * FROM CONSULTA;
SELECT M.APATERNO, M.AMATERNO, M.NOMBRE, COUNT(*) AS CONSULTAS FROM MEDICO M JOIN CONSULTA C ON M.ID_MEDICO = C.ID_MEDICO
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MIN(COUNT(*)) FROM MEDICO M JOIN CONSULTA C ON M.ID_MEDICO = C.ID_MEDICO
                                                  JOIN PACIENTE P ON P.ID_PACIENTE = C.ID_PACIENTE
GROUP BY M.APATERNO, M.AMATERNO, M.NOMBRE);